<link rel="stylesheet" href="/assets/css/exa.css">

<div class="login-card">
  <div class="card-header">
    <h1>Bienvenido</h1>
  </div>
  <div class="card-body">
    <form id="loginForm">
      <div class="form-group">
        <label for="username">Correo</label>
        <input type="text" id="username" name="username" required="">
      </div>
      <div class="form-group">
        <label for="password">Contraseña</label>
        <input type="password" id="password" name="password" required="">
      </div>
      <div class="form-group">
        <button type="submit" class="login-button">Iniciar Sesión</button>
      </div>
    </form>
  </div>
</div>

<script>
  document.getElementById('loginForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;

    const response = await fetch('/login', {
      // Asegúrate de que coincida con tu ruta POST
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password })
    });

    const data = await response.json();

    if (data.success) {
      const { id, nombre, apellido, telefono, correo, empresa} = data.user;
      sessionStorage.setItem('id', id);
      sessionStorage.setItem('nombre', nombre);
      sessionStorage.setItem('apellido', apellido);
      sessionStorage.setItem('telefono', telefono);
      sessionStorage.setItem('empresa', empresa);
      sessionStorage.setItem('correo', correo);

      window.location.href = '/dashboard';
    } else {
      alert(data.message);
    }
  });
</script>